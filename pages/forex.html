<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whalet - Forex Exchange</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../styles/custom.css">
    <style>
        body {
            font-family: 'Inter', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background-color: #f8fafc;
        }
        .tab-btn {
            border-bottom: 2px solid transparent;
            color: #6b7280;
        }
        .tab-btn:hover {
            color: #374151;
            border-bottom-color: #d1d5db;
        }
        .tab-btn.active {
            border-bottom: 2px solid #7D33FF;
            color: #7D33FF;
        }
        .card {
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid rgba(226, 232, 240, 0.8);
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.06);
        }
        .currency-flag {
            width: 24px;
            height: 16px;
            object-fit: cover;
            border-radius: 2px;
        }
        .step-indicator {
            display: flex;
            justify-content: space-between;
            position: relative;
            margin: 1.5rem 0 1rem;
            padding: 0 1rem;
        }
        .step-indicator::before {
            content: '';
            position: absolute;
            top: 24px;
            left: 2rem;
            right: 2rem;
            height: 2px;
            background: linear-gradient(to right, #7D33FF 33%, #e5e7eb 33%);
            z-index: 0;
        }
        .step {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }
        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(145deg, #ffffff, #f3f4f6);
            border: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .step-circle.active {
            background: linear-gradient(145deg, #7D33FF, #6422db);
            border-color: #7D33FF;
            color: white;
            box-shadow: 0 4px 12px rgba(125, 51, 255, 0.3);
        }
        .step-text {
            font-size: 0.875rem;
            color: #6b7280;
        }
        .step-text.active {
            color: #7D33FF;
            font-weight: 500;
        }
        .warning-box {
            background: linear-gradient(145deg, #fffbeb, #fef3c7);
            border: 1px solid rgba(251, 191, 36, 0.2);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(251, 191, 36, 0.05);
        }
        .exchange-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .exchange-arrow {
            width: 40px;
            height: 40px;
            background: linear-gradient(145deg, #f8fafc, #f1f5f9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1rem auto;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .currency-input {
            position: relative;
        }
        .currency-input input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 1rem;
        }
        .currency-input input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .currency-selector {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .currency-flag-large {
            width: 32px;
            height: 20px;
            object-fit: cover;
            border-radius: 2px;
            margin-right: 0.5rem;
        }
        .refresh-button {
            background: linear-gradient(145deg, #f8fafc, #f1f5f9);
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.375rem 0.75rem;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            transition: all 0.2s ease;
        }
        .refresh-button:hover {
            background: linear-gradient(145deg, #f1f5f9, #e2e8f0);
            border-color: #cbd5e1;
        }
        .rate-info {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
        }
        .countdown-badge {
            background: linear-gradient(145deg, #f1f5f9, #e2e8f0);
            border-radius: 1rem;
            padding: 0.25rem 0.75rem;
            font-size: 0.75rem;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }
        .fee-info {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
        }
        .info-icon {
            color: #9ca3af;
            margin-left: 0.25rem;
            cursor: pointer;
        }
        .next-button {
            background: linear-gradient(145deg, #7D33FF, #6422db);
            color: white;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(125, 51, 255, 0.2);
        }
        .next-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(125, 51, 255, 0.3);
        }
        .operation-time {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 1rem;
        }
        .vertical-line {
            position: relative;
        }
        .vertical-line::before {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            left: 50%;
            width: 1px;
            background-color: #e5e7eb;
        }
        .history-item {
            padding: 1.25rem;
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.2s ease;
        }
        .history-item:hover {
            background: linear-gradient(145deg, #f8fafc, #f1f5f9);
        }
        .history-header {
            position: sticky;
            top: 0;
            background-color: #f9fafb;
            z-index: 10;
        }
        .section-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        .exchange-card {
            background: white;
            border-radius: 1rem;
            border: 1px solid rgba(226, 232, 240, 0.8);
            padding: 1.5rem;
            margin-bottom: 0.75rem;
            box-shadow: 0 4px 6px -2px rgba(0, 0, 0, 0.03);
            transition: all 0.2s ease;
        }
        .exchange-card:hover {
            box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.06);
        }
        .exchange-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .currency-amount-input {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 0.875rem 1.25rem;
            width: 100%;
            font-size: 1rem;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.02);
        }
        .currency-amount-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .currency-dropdown {
            display: flex;
            align-items: center;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .currency-dropdown:hover {
            border-color: #3b82f6;
            box-shadow: 0 2px 4px rgba(59, 130, 246, 0.1);
        }
        .currency-option {
            transition: all 0.2s ease;
        }
        .currency-option:hover {
            background-color: #f8fafc;
        }
        .info-badge {
            background: linear-gradient(145deg, #f1f5f9, #e2e8f0);
            padding: 0.5rem 1rem;
            border-radius: 0.75rem;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.02);
        }
        .info-badge.warning {
            background: linear-gradient(145deg, #fee2e2, #fecaca);
            color: #b91c1c;
        }
        .info-badge.success {
            background: linear-gradient(145deg, #dcfce7, #bbf7d0);
            color: #15803d;
        }
        .exchange-rate-box {
            background: linear-gradient(145deg, #f8fafc, #f1f5f9);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin: 0.75rem 0;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.03);
        }
        .exchange-rate-box .w-10 {
            background: linear-gradient(to right, #7D33FF, #6422db);
        }
        .rate-button {
            color: #7D33FF;
            pointer-events: none;
            user-select: none;
        }
        .rate-button.clickable {
            pointer-events: auto;
            cursor: pointer;
        }
        .rate-button.clickable:hover {
            opacity: 0.9;
        }
        .status-badge {
            padding: 0.375rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }
        .status-badge.success {
            background: linear-gradient(145deg, #dcfce7, #bbf7d0);
            color: #15803d;
        }
        .status-badge.processing {
            background: linear-gradient(145deg, #fef3c7, #fef2c1);
            color: #a16207;
        }
        .status-badge.failed {
            background: linear-gradient(145deg, #fef2f2, #fef2f2);
            color: #b91c1c;
        }
        .rate-info-text {
            pointer-events: none;
            user-select: none;
            color: #6b7280;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-6">
        <!-- Main Content Area - Two Column Layout -->
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Left: Currency Exchange Process -->
            <div class="lg:w-2/3">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
                    <!-- Page Title -->
                    <div class="mb-6">
                        <h1 class="text-xl font-semibold text-gray-800">Forex Exchange</h1>
                    </div>

                    <!-- Step Indicator -->
                    <div class="step-indicator">
                        <div class="step">
                            <div class="step-circle active">
                                <i class="fas fa-pen-to-square"></i>
                            </div>
                            <div class="step-text active font-medium">Enter Exchange Info</div>
                        </div>
                        <div class="step">
                            <div class="step-circle">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="step-text font-medium">Confirm Exchange</div>
                        </div>
                        <div class="step">
                            <div class="step-circle">
                                <i class="fas fa-flag-checkered"></i>
                            </div>
                            <div class="step-text font-medium">Exchange Result</div>
                        </div>
                    </div>
                    
                    <!-- Step 1: Enter Exchange Info -->
                    <div class="exchange-form">
                        <!-- Warning Message -->
                        <div class="warning-box mb-3">
                            <div class="flex items-start">
                                <i class="fas fa-exclamation-circle text-amber-500 mt-0.5 mr-2"></i>
                                <p class="text-xs text-gray-700">Note: The exchange rates shown are not "real in" or "real out" rates, but interbank rates, which are wholesale rates for bank-to-bank transactions. The rates banks charge individuals do not include detailed costs, fees, and other charges. Please note that due to different trading rules and local variations, these rates are for reference only.</p>
                            </div>
                        </div>

                        <!-- Sell Section -->
                        <div class="exchange-card">
                            <div class="exchange-card-header">
                                <h3 class="font-medium text-gray-800">Sell</h3>
                                <div class="text-xs text-blue-600 flex items-center">
                                    <span>Available Balance</span>
                                    <span class="font-medium ml-1" id="selectedCurrencyBalance">1000.99 USD</span>
                                </div>
                            </div>
                            <div class="grid grid-cols-3 gap-4">
                                <div class="col-span-2">
                                    <input type="text" class="currency-amount-input cursor-not-allowed" id="sellAmountInput" value="1000.99" readonly style="background:#f3f4f6;">
                                </div>
                                <div class="relative">
                                    <button id="sellCurrencyDropdown" class="currency-dropdown w-full">
                                        <img src="https://flagcdn.com/w40/us.png" alt="USD" class="currency-flag-large" id="sellCurrencyFlag">
                                        <span class="ml-2" id="sellCurrencyText">USD</span>
                                        <i class="fas fa-chevron-down ml-auto text-gray-400"></i>
                                    </button>
                                    <div id="sellCurrencyOptions" class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <div class="p-2">
                                            <div class="currency-option hover:bg-gray-50 p-2 rounded cursor-pointer" data-currency="USD" data-balance="18,983.87USD" data-flag="us">
                                                <div class="flex items-center">
                                                    <img src="https://flagcdn.com/w40/us.png" alt="USD" class="currency-flag-large">
                                                    <div class="ml-2">
                                                        <div>USD</div>
                                                        <div class="text-xs text-gray-500">Balance 18,983.87USD</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="currency-option hover:bg-gray-50 p-2 rounded cursor-pointer" data-currency="JPY" data-balance="196JPY" data-flag="jp">
                                                <div class="flex items-center">
                                                    <img src="https://flagcdn.com/w40/jp.png" alt="JPY" class="currency-flag-large">
                                                    <div class="ml-2">
                                                        <div>JPY</div>
                                                        <div class="text-xs text-gray-500">Balance 196JPY</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="currency-option hover:bg-gray-50 p-2 rounded cursor-pointer" data-currency="EUR" data-balance="0.00EUR" data-flag="eu">
                                                <div class="flex items-center">
                                                    <img src="https://flagcdn.com/w40/eu.png" alt="EUR" class="currency-flag-large">
                                                    <div class="ml-2">
                                                        <div>EUR</div>
                                                        <div class="text-xs text-gray-500">Balance 0.00EUR</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Exchange Rate Info -->
                        <div class="exchange-rate-box">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center">
                                    <div class="text-sm text-gray-600">Fee</div>
                                    <div class="text-sm font-medium ml-2">3.00 USD</div>
                                    <a href="#" class="text-blue-600 text-sm ml-2">View Details</a>
                                </div>
                            </div>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center" id="rateContainer">
                                    <div class="text-sm text-gray-600">Reference Rate</div>
                                    <div class="text-sm font-medium ml-2">USD/CNH = </div>
                                    <div class="text-sm font-medium ml-2" id="rateValue">7.2345</div>
                                    <div class="text-sm text-red-500 font-medium ml-2 hidden" id="rateExpired">Rate Expired</div>
                                    <button class="text-blue-600 text-sm ml-2 hidden" id="refreshRate">Refresh</button>
                                    <div class="text-sm text-gray-600 ml-2" id="countdown">
                                        <span id="timer">15</span>
                                        <span class="ml-1">seconds</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Buy Section -->
                        <div class="exchange-card">
                            <div class="exchange-card-header">
                                <h3 class="font-medium text-gray-800">Buy</h3>
                            </div>
                            <div class="grid grid-cols-3 gap-4">
                                <div class="col-span-2">
                                    <input type="text" class="currency-amount-input bg-gray-50" value="894.98" readonly>
                                </div>
                                <div class="relative">
                                    <button id="buyCurrencyDropdown" class="currency-dropdown w-full">
                                        <img src="https://flagcdn.com/w40/eu.png" alt="EUR" class="currency-flag-large" id="buyCurrencyFlag">
                                        <span class="ml-2" id="buyCurrencyText">EUR</span>
                                        <i class="fas fa-chevron-down ml-auto text-gray-400"></i>
                                    </button>
                                    <div id="buyCurrencyOptions" class="absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <div class="p-2">
                                            <div class="currency-option hover:bg-gray-50 p-2 rounded cursor-pointer" data-currency="USD" data-flag="us">
                                                <div class="flex items-center">
                                                    <img src="https://flagcdn.com/w40/us.png" alt="USD" class="currency-flag-large">
                                                    <div class="ml-2">USD</div>
                                                </div>
                                            </div>
                                            <div class="currency-option hover:bg-gray-50 p-2 rounded cursor-pointer" data-currency="JPY" data-flag="jp">
                                                <div class="flex items-center">
                                                    <img src="https://flagcdn.com/w40/jp.png" alt="JPY" class="currency-flag-large">
                                                    <div class="ml-2">JPY</div>
                                                </div>
                                            </div>
                                            <div class="currency-option hover:bg-gray-50 p-2 rounded cursor-pointer" data-currency="EUR" data-flag="eu">
                                                <div class="flex items-center">
                                                    <img src="https://flagcdn.com/w40/eu.png" alt="EUR" class="currency-flag-large">
                                                    <div class="ml-2">EUR</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Next Button -->
                        <div class="flex justify-center mt-6">
                            <button class="next-button w-full md:w-1/2">Next</button>
                        </div>
                    </div>

                    <!-- Step 2: Confirm Exchange Info -->
                    <div class="confirmation-form" style="display: none;">
                        <!-- Rate Countdown Notice -->
                        <div class="bg-gray-50 p-4 rounded-lg mb-4">
                            <div id="confirmationTimer" class="text-gray-700 text-sm">
                                <span>You need to confirm your transaction within </span>
                                <span class="text-red-500 font-medium" id="confirmCountdown">15</span>
                                <span> seconds</span>
                            </div>
                            <div id="confirmationExpired" class="hidden text-gray-700 text-sm">
                                Your exchange rate has expired, please get a new price
                            </div>
                        </div>

                        <!-- Exchange Info List -->
                        <div class="space-y-6">
                            <!-- Sell -->
                            <div class="flex items-start">
                                <div class="w-6 flex-shrink-0 mr-2">
                                    <i class="fas fa-upload text-gray-400"></i>
                                </div>
                                <div>
                                    <div class="text-gray-500 text-sm">Sell</div>
                                    <div class="flex items-center mt-1">
                                        <span class="text-base">1,000.99 USD</span>
                                        <img src="https://flagcdn.com/w20/us.png" alt="USD" class="ml-2 w-4 h-3">
                                    </div>
                                </div>
                            </div>

                            <!-- Fee -->
                            <div class="flex items-start">
                                <div class="w-6 flex-shrink-0 mr-2">
                                    <i class="fas fa-dollar-sign text-gray-400"></i>
                                </div>
                                <div>
                                    <div class="text-gray-500 text-sm">Fee</div>
                                    <div class="text-base mt-1">20.00 USD</div>
                                </div>
                            </div>

                            <!-- Reference Rate -->
                            <div class="flex items-start">
                                <div class="w-6 flex-shrink-0 mr-2">
                                    <i class="fas fa-exchange-alt text-gray-400"></i>
                                </div>
                                <div>
                                    <div class="text-gray-500 text-sm">Reference Rate</div>
                                    <div class="text-base mt-1">USD/EUR = 0.8900</div>
                                </div>
                            </div>

                            <!-- Buy -->
                            <div class="flex items-start">
                                <div class="w-6 flex-shrink-0 mr-2">
                                    <i class="fas fa-download text-gray-400"></i>
                                </div>
                                <div>
                                    <div class="text-gray-500 text-sm">Buy</div>
                                    <div class="flex items-center mt-1">
                                        <span class="text-base">894.98 EUR</span>
                                        <img src="https://flagcdn.com/w20/eu.png" alt="EUR" class="ml-2 w-4 h-3">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Transaction Password Input -->
                        <div class="mt-6">
                            <div class="mb-2">
                                <label class="text-gray-700">
                                    Transaction Password
                                    <span class="text-red-500">*</span>
                                </label>
                                <input type="password" class="w-full mt-1 px-3 py-2 border border-gray-300 rounded focus:border-blue-500 focus:ring-1 focus:ring-blue-500" placeholder="Please enter transaction password" id="transactionPassword">
                                <div class="text-red-500 text-sm mt-1 hidden" id="passwordError">Please enter transaction password</div>
                            </div>
                            <a href="#" class="text-blue-600 text-sm">Forgot Transaction Password?</a>
                        </div>

                        <!-- Button Group -->
                        <div class="flex space-x-4 mt-6">
                            <button class="px-6 py-2 bg-blue-600 text-white rounded">
                                Confirm Submit
                            </button>
                            <button class="px-6 py-2 bg-blue-600 text-white rounded hidden" id="confirmationRefreshRateBottom">
                                Get New Price
                            </button>
                            <button class="px-6 py-2 text-gray-700 border border-gray-300 rounded">
                                Previous
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Exchange Result -->
                    <div class="result-form" style="display: none;">
                        <div class="flex flex-col items-center justify-center py-8">
                            <!-- Success Icon -->
                            <div class="w-20 h-20 rounded-full bg-green-400 flex items-center justify-center mb-6">
                                <i class="fas fa-check text-white text-3xl"></i>
                            </div>
                            
                            <!-- Success Title -->
                            <h2 class="text-xl font-medium text-gray-900 mb-2">Exchange Request Successful</h2>
                            
                            <!-- Success Description -->
                            <p class="text-gray-600 mb-8">Exchange request submitted successfully, waiting for bank processing!</p>
                            
                            <!-- Button Group -->
                            <div class="flex space-x-4">
                                <a href="#" class="text-blue-600 hover:text-blue-700 font-medium" id="viewExchangeHistoryLink">
                                    View Exchange History
                                </a>
                                <a href="#" class="text-blue-600 hover:text-blue-700 font-medium">
                                    Continue Forex Exchange
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Right: Exchange History -->
            <div class="lg:w-1/3">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                    <div class="p-6 border-b border-gray-100">
                        <h2 class="text-xl font-semibold text-gray-800">Exchange History</h2>
                    </div>

                    <div class="overflow-y-auto max-h-[600px] px-2">
                        <!-- History Items -->
                        <div class="history-item rounded-xl">
                            <div class="flex justify-between items-center mb-3">
                                <div class="text-sm font-medium text-gray-900">May 10, 2023</div>
                                <span class="status-badge success">
                                    <i class="fas fa-check-circle"></i>
                                    Transaction Successful
                                </span>
                            </div>
                            <div class="flex items-center mb-2">
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/us.png" alt="USD" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">$2,000.00</div>
                                </div>
                                <i class="fas fa-arrow-right mx-2 text-gray-400"></i>
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/eu.png" alt="EUR" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">€1,860.00</div>
                                </div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-500">
                                <div>Rate: 1 USD = 0.9300 EUR</div>
                                <div>Fee: $5.00</div>
                            </div>
                        </div>
                        
                        <div class="history-item rounded-xl">
                            <div class="flex justify-between items-center mb-3">
                                <div class="text-sm font-medium text-gray-900">May 5, 2023</div>
                                <span class="status-badge processing">
                                    <i class="fas fa-clock"></i>
                                    Processing
                                </span>
                            </div>
                            <div class="flex items-center mb-2">
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/gb.png" alt="GBP" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">£1,500.00</div>
                                </div>
                                <i class="fas fa-arrow-right mx-2 text-gray-400"></i>
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/us.png" alt="USD" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">$1,878.00</div>
                                </div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-500">
                                <div>Rate: 1 GBP = 1.2520 USD</div>
                                <div>Fee: £3.75</div>
                            </div>
                        </div>
                        
                        <div class="history-item rounded-xl">
                            <div class="flex justify-between items-center mb-3">
                                <div class="text-sm font-medium text-gray-900">April 28, 2023</div>
                                <span class="status-badge failed">
                                    <i class="fas fa-times-circle"></i>
                                    Transaction Failed
                                </span>
                            </div>
                            <div class="flex items-center mb-2">
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/us.png" alt="USD" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">$5,000.00</div>
                                </div>
                                <i class="fas fa-arrow-right mx-2 text-gray-400"></i>
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/cn.png" alt="CNY" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">¥36,150.00</div>
                                </div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-500">
                                <div>Rate: 1 USD = 7.2300 CNY</div>
                                <div>Fee: $12.50</div>
                            </div>
                        </div>
                        
                        <div class="history-item rounded-xl">
                            <div class="flex justify-between items-center mb-3">
                                <div class="text-sm font-medium text-gray-900">April 15, 2023</div>
                                <span class="status-badge success">
                                    <i class="fas fa-check-circle"></i>
                                    Transaction Successful
                                </span>
                            </div>
                            <div class="flex items-center mb-2">
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/eu.png" alt="EUR" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">€3,000.00</div>
                                </div>
                                <i class="fas fa-arrow-right mx-2 text-gray-400"></i>
                                <div class="flex items-center">
                                    <img src="https://flagcdn.com/w40/us.png" alt="USD" class="currency-flag mr-2">
                                    <div class="text-sm font-medium text-gray-900">$3,270.00</div>
                                </div>
                            </div>
                            <div class="flex justify-between text-xs text-gray-500">
                                <div>Rate: 1 EUR = 1.0900 USD</div>
                                <div>Fee: €7.50</div>
                            </div>
                        </div>
                    </div>

                    <div class="p-4 border-t border-gray-200 bg-gray-50">
                        <button id="viewAllExchangeHistory" class="w-full text-blue-600 hover:text-blue-800 text-sm font-medium">
                            View All Exchange History
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 用户中心下拉菜单
            const userCenterBtn = document.getElementById('userCenterBtn');
            const userCenterDropdown = document.getElementById('userCenterDropdown');
            
            if (userCenterBtn && userCenterDropdown) {
                userCenterBtn.addEventListener('click', function() {
                    userCenterDropdown.classList.toggle('hidden');
                });
                
                // 点击其他地方关闭下拉菜单
                document.addEventListener('click', function(event) {
                    if (!userCenterBtn.contains(event.target) && !userCenterDropdown.contains(event.target)) {
                        userCenterDropdown.classList.add('hidden');
                    }
                });
            }

            // 处理步骤切换
            function showStep(stepNumber) {
                const step1Content = document.querySelector('.exchange-form');
                const step2Content = document.querySelector('.confirmation-form');
                const step3Content = document.querySelector('.result-form');
                const steps = document.querySelectorAll('.step');

                steps.forEach((step, index) => {
                    const circle = step.querySelector('.step-circle');
                    const text = step.querySelector('.step-text');
                    if (index + 1 === stepNumber) {
                        circle.classList.add('active');
                        text.classList.add('active');
                    } else {
                        circle.classList.remove('active');
                        text.classList.remove('active');
                    }
                });

                if (stepNumber === 1) {
                    step1Content.style.display = 'block';
                    step2Content.style.display = 'none';
                    step3Content.style.display = 'none';
                } else if (stepNumber === 2) {
                    step1Content.style.display = 'none';
                    step2Content.style.display = 'block';
                    step3Content.style.display = 'none';
                    // 进入第二步时启动倒计时
                    startConfirmationCountdown();
                } else if (stepNumber === 3) {
                    step1Content.style.display = 'none';
                    step2Content.style.display = 'none';
                    step3Content.style.display = 'block';
                }
            }

            // 绑定按钮事件
            const nextButton = document.querySelector('.next-button');
            const prevButton = Array.from(document.querySelectorAll('button')).find(button => button.textContent.trim() === 'Previous');
            const submitButton = Array.from(document.querySelectorAll('button')).find(button => button.textContent.trim() === 'Confirm Submit');
            const refreshButton = Array.from(document.querySelectorAll('button')).find(button => button.textContent.trim() === 'Refresh');
            const passwordInput = document.querySelector('#transactionPassword');

            // 绑定结果页面的链接事件
            const viewRecordLink = Array.from(document.querySelectorAll('a')).find(link => link.textContent.trim() === 'View Exchange History');
            const continueExchangeLink = Array.from(document.querySelectorAll('a')).find(link => link.textContent.trim() === 'Continue Forex Exchange');

            if (nextButton) {
                nextButton.addEventListener('click', () => {
                    console.log('Next Button Clicked');
                    showStep(2);
                });
            }

            if (prevButton) {
                prevButton.addEventListener('click', () => {
                    console.log('Previous Button Clicked');
                    showStep(1);
                });
            }

            if (submitButton && passwordInput) {
                submitButton.addEventListener('click', () => {
                    if (!passwordInput.value.trim()) {
                        passwordError.classList.remove('hidden');
                        passwordInput.classList.add('border-red-500');
                        return;
                    }
                    
                    passwordError.classList.add('hidden');
                    passwordInput.classList.remove('border-red-500');
                    // 模拟验证成功后跳转到第三步
                    showStep(3);
                });

                // 输入框获得焦点时隐藏错误提示
                passwordInput.addEventListener('focus', () => {
                    passwordError.classList.add('hidden');
                    passwordInput.classList.remove('border-red-500');
                });
            }

            if (refreshButton) {
                refreshButton.addEventListener('click', () => {
                    startCountdown();
                });
            }

            // 结果页面的链接事件
            if (viewRecordLink) {
                viewRecordLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.href = 'forex-transaction.html?tab=exchange';
                });
            }

            if (continueExchangeLink) {
                continueExchangeLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.reload();
                });
            }

            // 查看全部兑换历史按钮点击事件
            const viewAllExchangeHistoryBtn = document.getElementById('viewAllExchangeHistory');
            if (viewAllExchangeHistoryBtn) {
                viewAllExchangeHistoryBtn.addEventListener('click', function() {
                    window.location.href = 'forex-transaction.html';
                });
            }

            // 汇率倒计时功能
            const rateValue = document.getElementById('rateValue');
            const rateExpired = document.getElementById('rateExpired');
            const refreshRateBtn = document.getElementById('refreshRate');
            const timerElement = document.getElementById('timer');
            const countdown = document.getElementById('countdown');
            
            let countdownInterval;
            let timeLeft = 15;

            function startCountdown() {
                // 显示汇率，隐藏失效提示和刷新按钮
                rateValue.classList.remove('hidden');
                rateExpired.classList.add('hidden');
                refreshRateBtn.classList.add('hidden');
                countdown.classList.remove('hidden');
                
                // 重置时间
                timeLeft = 15;
                timerElement.textContent = timeLeft;
                
                // 清除之前的计时器
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                }
                
                // 启动新的计时器
                countdownInterval = setInterval(() => {
                    timeLeft--;
                    timerElement.textContent = timeLeft;
                    
                    if (timeLeft <= 0) {
                        clearInterval(countdownInterval);
                        // 显示汇率失效和刷新按钮
                        rateValue.classList.add('hidden');
                        rateExpired.classList.remove('hidden');
                        refreshRateBtn.classList.remove('hidden');
                        countdown.classList.add('hidden');
                    }
                }, 1000);
            }

            // 点击刷新按钮重新开始计时
            refreshRateBtn.addEventListener('click', () => {
                startCountdown();
            });

            // 页面加载时开始第一次计时
            startCountdown();

            // 卖出币种下拉功能
            const sellCurrencyDropdown = document.getElementById('sellCurrencyDropdown');
            const sellCurrencyOptions = document.getElementById('sellCurrencyOptions');
            const sellCurrencyFlag = document.getElementById('sellCurrencyFlag');
            const sellCurrencyText = document.getElementById('sellCurrencyText');
            const selectedCurrencyBalance = document.getElementById('selectedCurrencyBalance');

            sellCurrencyDropdown.addEventListener('click', () => {
                sellCurrencyOptions.classList.toggle('hidden');
            });

            // 买入币种下拉功能
            const buyCurrencyDropdown = document.getElementById('buyCurrencyDropdown');
            const buyCurrencyOptions = document.getElementById('buyCurrencyOptions');
            const buyCurrencyFlag = document.getElementById('buyCurrencyFlag');
            const buyCurrencyText = document.getElementById('buyCurrencyText');

            buyCurrencyDropdown.addEventListener('click', () => {
                buyCurrencyOptions.classList.toggle('hidden');
            });

            // 点击其他地方关闭下拉菜单
            document.addEventListener('click', (event) => {
                if (!sellCurrencyDropdown.contains(event.target)) {
                    sellCurrencyOptions.classList.add('hidden');
                }
                if (!buyCurrencyDropdown.contains(event.target)) {
                    buyCurrencyOptions.classList.add('hidden');
                }
            });

            // 卖出币种选项点击事件
            document.querySelectorAll('#sellCurrencyOptions .currency-option').forEach(option => {
                option.addEventListener('click', () => {
                    const currency = option.dataset.currency;
                    const balance = option.dataset.balance;
                    const flag = option.dataset.flag;
                    
                    sellCurrencyFlag.src = `https://flagcdn.com/w40/${flag}.png`;
                    sellCurrencyFlag.alt = currency;
                    sellCurrencyText.textContent = currency;
                    selectedCurrencyBalance.textContent = balance;
                    // 自动填充卖出金额并只读
                    document.getElementById('sellAmountInput').value = balance.replace(/[^\d.]/g, '');
                    sellCurrencyOptions.classList.add('hidden');
                });
            });

            // 买入币种选项点击事件
            document.querySelectorAll('#buyCurrencyOptions .currency-option').forEach(option => {
                option.addEventListener('click', () => {
                    const currency = option.dataset.currency;
                    const flag = option.dataset.flag;
                    
                    buyCurrencyFlag.src = `https://flagcdn.com/w40/${flag}.png`;
                    buyCurrencyFlag.alt = currency;
                    buyCurrencyText.textContent = currency;
                    
                    buyCurrencyOptions.classList.add('hidden');
                });
            });

            // 获取货币名称
            function getCurrencyName(currency) {
                const names = {
                    'USD': 'USD',
                    'JPY': 'JPY',
                    'EUR': 'EUR'
                };
                return names[currency] || '';
            }

            // 确认页面倒计时功能
            let confirmationInterval;
            let confirmationTimeLeft = 15;

            function startConfirmationCountdown() {
                const confirmCountdown = document.getElementById('confirmCountdown');
                const confirmationTimer = document.getElementById('confirmationTimer');
                const confirmationExpired = document.getElementById('confirmationExpired');
                const confirmationRefreshRateBottom = document.getElementById('confirmationRefreshRateBottom');
                
                // 重置时间
                confirmationTimeLeft = 15;
                
                // 显示倒计时，隐藏过期提示和底部刷新按钮
                confirmationTimer.classList.remove('hidden');
                confirmationExpired.classList.add('hidden');
                confirmationRefreshRateBottom.classList.add('hidden');
                
                // 更新倒计时显示
                confirmCountdown.textContent = confirmationTimeLeft;
                
                // 清除之前的计时器
                if (confirmationInterval) {
                    clearInterval(confirmationInterval);
                }
                
                // 启动新的计时器
                confirmationInterval = setInterval(() => {
                    confirmationTimeLeft--;
                    confirmCountdown.textContent = confirmationTimeLeft;
                    
                    if (confirmationTimeLeft <= 0) {
                        clearInterval(confirmationInterval);
                        // 显示过期提示和底部刷新按钮
                        confirmationTimer.classList.add('hidden');
                        confirmationExpired.classList.remove('hidden');
                        confirmationRefreshRateBottom.classList.remove('hidden');
                    }
                }, 1000);
            }

            // 点击底部重新获取价格按钮
            const confirmationRefreshRateBottom = document.getElementById('confirmationRefreshRateBottom');
            if (confirmationRefreshRateBottom) {
                confirmationRefreshRateBottom.addEventListener('click', () => {
                    startConfirmationCountdown();
                });
            }

            // 初始化显示第一步
            showStep(1);
        });
    </script>
</body>
</html> 